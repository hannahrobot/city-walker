(this["webpackJsonpcity-walker"]=this["webpackJsonpcity-walker"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var r,i,c=n(3),a=n(2),o=n.n(a),s=n(29),l=n.n(s),u=(n(77),n(20)),d=n.n(u),j=n(27),h=n(6),b=n(9),p=n(16),m=n(7),O=n(8),g=n(18),f=n(5),x=n(61),v=[],y=[39,232,1];function S(){return(S=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=x.a("BROWSER_FFT"),e.next=4,r.ensureModelLoaded();case 4:L(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function w(e){if(r.isListening())return r.stopListening();null!=e&&r.listen(function(){var t=Object(j.a)(d.a.mark((function t(n){var r,i,c,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.spectrogram,i=r.frameSize,c=r.data,a=k(c.subarray(39*-i)),v.push({vals:a,label:e}),document.querySelector("#console").textContent="".concat(v.length," examples collected");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{overlapFactor:.999,includeSpectrogram:!0,invokeCallbackOnNoiseAndUnknown:!0})}function k(e){return e.map((function(e){return(e- -100)/10}))}function M(){return P.apply(this,arguments)}function P(){return(P=Object(j.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I(!1),t=f.k(v.map((function(e){return e.label})),5),n=[v.length].concat(y),r=f.o(C(v.map((function(e){return e.vals}))),n),e.next=7,i.fit(r,t,{batchSize:208,epochs:130,callbacks:{onEpochEnd:function(e,t){document.querySelector("#console").textContent="Accuracy: ".concat((100*t.acc).toFixed(1),"% Epoch: ").concat(e+1)}}});case 7:f.d([r,t]),I(!0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function L(){(i=f.m()).add(f.g.depthwiseConv2d({depthMultiplier:8,kernelSize:[39,3],activation:"relu",inputShape:y})),i.add(f.g.maxPooling2d({poolSize:[1,2],strides:[2,2]})),i.add(f.g.flatten()),i.add(f.g.dense({units:5,activation:"softmax"}));var e=f.u.adam(.01);i.compile({optimizer:e,loss:"categoricalCrossentropy",metrics:["accuracy"]})}function I(e){document.querySelectorAll("button").forEach((function(t){return t.disabled=!e}))}function C(e){var t=e[0].length,n=new Float32Array(e.length*t);return e.forEach((function(e,r){return n.set(e,r*t)})),n}function A(e){return E.apply(this,arguments)}function E(){return(E=Object(j.a)(d.a.mark((function e(t){var n,r,i,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.data();case 3:n=e.sent[0],r=+document.getElementById("output").value,i=+document.getElementById("output2").value,document.getElementById("console").textContent=n,c=.1,e.t0=n,e.next=0===e.t0?11:1===e.t0?13:3===e.t0?15:4===e.t0?17:19;break;case 11:return document.getElementById("output").value=r-c,e.abrupt("break",20);case 13:return document.getElementById("output").value=r+c,e.abrupt("break",20);case 15:return document.getElementById("output2").value=i-c,e.abrupt("break",20);case 17:return document.getElementById("output2").value=i+c,e.abrupt("break",20);case 19:return e.abrupt("break",20);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(0),console.log(e.t1);case 25:case"end":return e.stop()}}),e,null,[[0,22]])})))).apply(this,arguments)}function T(){if(r.isListening())return r.stopListening(),I(!0),void(document.getElementById("listen").textContent="Listen");I(!1),document.getElementById("listen").textContent="Stop",document.getElementById("listen").disabled=!1,r.listen(function(){var e=Object(j.a)(d.a.mark((function e(t){var n,r,c,a,o,s,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spectrogram,r=n.frameSize,c=n.data,a=k(c.subarray(39*-r)),o=f.o(a,[1].concat(y)),s=i.predict(o),l=s.argMax(1),e.next=7,A(l);case 7:f.d([o,s,l]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{overlapFactor:.999,includeSpectrogram:!0,probabilityThreshold:.9})}function G(){r.stopListening()}!function(){S.apply(this,arguments)}();var D=n(109),N=n(104),W=n(10),B=n(30),z=n.p+"static/media/scene.4ff4455c.glb",R=n(108),F=n(112),U=n(107),_=function(e){var t=Object(a.useRef)(),n=window.innerWidth-8-.2*window.innerWidth;return Object(g.b)((function(r){var i=r.gl,c=r.scene,a=r.camera;i.autoClear=!0,i.setViewport(0,0,window.innerWidth,window.innerHeight),i.setScissor(0,0,window.innerWidth,window.innerHeight),i.setScissorTest(!0),i.render(c,a),i.autoClear=!1,i.clearDepth(),i.setViewport(n,8,.2*window.innerWidth,.2*window.innerHeight),i.setScissor(n,8,.2*window.innerWidth,.2*window.innerHeight),i.setScissorTest(!0),t.current.position.x=e.viewPosition.x,t.current.position.y=300,t.current.position.z=e.viewPosition.z,t.current.updateMatrixWorld(),t.current.updateProjectionMatrix(),i.render(c,t.current)}),1),Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(U.a,{ref:t,zoom:4.5,rotation:[-90*Math.PI/180,0,0],left:-400,right:400,top:400,bottom:-400,far:500,near:250})})},H=n(24),q=0,V=0,Y=0,K=Object(H.b)((function(e){return{position:e.position}}),null)((function(e){var t,n=Object(g.c)(B.a,z),r=Object(N.c)((function(){return{mass:6,args:[6,6,6],position:e.girlPosition}})),i=Object(W.a)(r,2),a=i[0],o=i[1];a.current&&(t=a.current.position);var s=e.position;return Object(g.b)((function(){switch(t.x>=s.x-10&&t.x<=s.x+10&&t.z>=s.z-10&&t.z<=s.z+10&&(e.stopListening(),e.changeWin(),e.changePlaying()),o.rotation.set(0,-90*Math.PI/180,0),e.action){case 1:(Y+=10)>=10&&e.setAction("");break;case 0:(Y-=10)<=-10&&e.setAction("");break;case 4:V=20,0===q&&(q+=5),e.setAction("");break;case 3:Y=0,V=0,q=0,e.setAction("");break;case 2:e.setAction("")}o.velocity.set(Y,-1,-V*q)})),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("mesh",{ref:a,frustumCulled:!1,children:[Object(c.jsx)(R.a,{fov:75,near:.1,position:[15,7.5,0],rotation:[0,90*Math.PI/180,0],makeDefault:!0}),Object(c.jsx)("primitive",{object:n.scene,scale:[5,5,5],rotation:[0,-65*Math.PI/180,0],position:[0,-7,0]}),Object(c.jsx)(F.a,{})]}),Object(c.jsx)(_,{viewPosition:t})]})})),J=n.p+"static/media/maria.56eb6240.glb",X=function(e){var t=Object(g.c)(B.a,J),n=Object(N.c)((function(){return{mass:1,args:[6,5,6],position:[3,10,120],rotation:[0,-25*Math.PI/180,0]}})),r=Object(W.a)(n,1)[0];return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("mesh",{ref:r,children:Object(c.jsx)("primitive",{object:t.scene,scale:[8,8,8]})})})},Q=n.p+"static/media/scene.f3c54604.glb",Z=function(e){var t=Object(g.c)(B.a,Q),n=Object(N.c)((function(){return{mass:2,args:[3,6,3],position:[-8,2,-50]}})),r=Object(W.a)(n,1)[0],i=Object(N.c)((function(){return{mass:2,args:[3,6,3],position:[0,2,-30],rotation:[0,-65*Math.PI/180,0]}})),a=Object(W.a)(i,1)[0],o=Object(N.c)((function(){return{mass:2,args:[3,6,3],position:[8,2,-50],rotation:[0,-80*Math.PI/180,0]}})),s=Object(W.a)(o,1)[0],l=Object(N.c)((function(){return{mass:2,args:[3,6,3],position:[10,2,-35],rotation:[0,-80*Math.PI/180,0]}})),u=Object(W.a)(l,1)[0],d=Object(N.c)((function(){return{mass:2,args:[3,6,3],position:[0,2,-45],rotation:[0,-80*Math.PI/180,0]}})),j=Object(W.a)(d,1)[0];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("mesh",{ref:r,children:Object(c.jsx)("primitive",{object:t.scene,scale:[7,7,7]})}),Object(c.jsx)("mesh",{ref:a,children:Object(c.jsx)("primitive",{object:t.scene.clone(!0),scale:[7,7,7]})}),Object(c.jsx)("mesh",{ref:s,children:Object(c.jsx)("primitive",{object:t.scene.clone(!0),scale:[7,7,7]})}),Object(c.jsx)("mesh",{ref:u,children:Object(c.jsx)("primitive",{object:t.scene.clone(!0),scale:[7,7,7]})}),Object(c.jsx)("mesh",{ref:j,children:Object(c.jsx)("primitive",{object:t.scene.clone(!0),scale:[7,7,7]})})]})},$=n.p+"static/media/goth.ea91a7a1.glb",ee=function(e){var t=Object(g.c)(B.a,$),n=Object(N.c)((function(){return{mass:1,args:[7,5,7],position:[4,0,-340],rotation:[0,-25*Math.PI/180,0]}})),r=Object(W.a)(n,1)[0];return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("mesh",{ref:r,children:Object(c.jsx)("primitive",{object:t.scene,scale:[.25,.25,.25],position:[0,-3,0]})})})},te=function(){return Object(c.jsxs)("mesh",{children:[Object(c.jsx)("boxBufferGeometry",{attach:"geometry",args:[1,1,1]}),Object(c.jsx)("meshStandardMaterial",{attach:"material",transparent:!0,opacity:300})]})},ne=n.p+"static/media/scene.2ce1c094.glb",re=function(e){var t=Object(g.c)(B.a,ne).scene,n=Object(N.c)((function(){return{type:"Kinematic",args:[4.7,1.1,2],position:e.position,rotation:e.rotation}})),r=Object(W.a)(n,1)[0];return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)("mesh",{ref:r,children:[Object(c.jsxs)("group",{dispose:null,children:[Object(c.jsx)("primitive",{object:t,scale:[.04,.04,.04]}),Object(c.jsx)("primitive",{object:t.clone(!0),scale:[.04,.04,.04],position:[e.position[0]+190,0,0]}),Object(c.jsx)("primitive",{object:t.clone(!0),scale:[.04,.04,.04],position:[e.position[0]+370,0,0]}),Object(c.jsx)("primitive",{object:t.clone(!0),scale:[.04,.04,.04],position:[e.position[0]+550,0,0]})]}),Object(c.jsx)("meshStandardMaterial",{wireframe:!0,attach:"material"})]})})},ie=n(13),ce=function(e){var t=Object(N.e)((function(){return Object(ie.a)({position:e.position,mass:0},e)})),n=Object(W.a)(t,1)[0];return Object(c.jsxs)("mesh",{ref:n,receiveShadow:!0,children:[Object(c.jsx)("planeBufferGeometry",{attach:"geometry",args:[45,1450]}),Object(c.jsx)("meshStandardMaterial",{attach:"material",transparent:!0,opacity:0})]})},ae=function(e){var t=Object(N.e)((function(){return Object(ie.a)({rotation:e.rotation,position:e.position,mass:0},e)})),n=Object(W.a)(t,1)[0];return Object(c.jsxs)("mesh",{ref:n,children:[Object(c.jsx)("planeBufferGeometry",{attach:"geometry",args:[1400,20]}),Object(c.jsx)("meshStandardMaterial",{attach:"material",transparent:!0,opacity:0})]})},oe=function(e){var t=Object(N.e)((function(){return Object(ie.a)({rotation:e.rotation,position:e.position,mass:0},e)})),n=Object(W.a)(t,1)[0];return Object(c.jsxs)("mesh",{ref:n,children:[Object(c.jsx)("planeBufferGeometry",{attach:"geometry",args:[100,100]}),Object(c.jsx)("meshStandardMaterial",{attach:"material",transparent:!0,opacity:0})]})},se="GET_POSITION",le={};var ue=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).zoneRef=o.a.createRef(),e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.props.getPosition(this.zoneRef.current.position)}},{key:"render",value:function(){return Object(c.jsxs)("mesh",{ref:this.zoneRef,position:[-2,0,-450],children:[Object(c.jsx)("boxBufferGeometry",{attach:"geometry",args:[30,50,20]}),Object(c.jsx)("meshStandardMaterial",{wireframe:!1,attach:"material",color:"yellow",transparent:!0,opacity:.6})]})}}]),n}(o.a.Component),de=Object(H.b)(null,(function(e){return{getPosition:function(t){return e(function(e){return{type:se,position:e}}(t))}}}))(ue),je=n(35),he=n(69),be=n(70),pe="GET_GAMESTATE",me="GAMESTATE_WIN",Oe="GAMESTATE_PLAYING",ge="RESET_GAMESTATE",fe="RESTART_GAME_STATE",xe={isPlaying:!1,hasWon:!1,isPaused:!1,courseCompleted:!1};var ve=n(23),ye=n(57);n(60),n(100);ye.a.initializeApp({apiKey:"AIzaSyCDIEz8pqLI9IAt5bgXYy90t7iw_zLtUEA",authDomain:"city-walker.firebaseapp.com",projectId:"city-walker",storageBucket:"city-walker.appspot.com",messagingSenderId:"234520776294",appId:"1:234520776294:web:0a9c644ab3eb85f06e67a7",measurementId:"G-NELH08XYYR"});var Se=ye.a.firestore().collection("leaderboard"),we="GET_LEADERBOARD",ke="ADD_TO_LEADERBOARD",Me=[],Pe=function(e){return{type:we,leaderboard:e}},Le=function(e){return{type:ke,newRecord:e}};var Ie="UPDATE_TIME";var Ce=Object(je.combineReducers)({gameState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case pe:return e;case me:return Object(ie.a)(Object(ie.a)({},e),{},{hasWon:t.hasWon});case Oe:return Object(ie.a)(Object(ie.a)({},e),{},{isPlaying:t.isPlaying});case ge:return Object(ie.a)(Object(ie.a)({},e),{},{isPlaying:!0,hasWon:!1});case fe:return xe;default:return e}},leaderboard:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case we:return t.leaderboard;case ke:return[].concat(Object(ve.a)(e),[t.newRecord]);default:return e}},position:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case se:return t.position;default:return e}},time:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ie:return t.time;default:return e}}}),Ae=Object(be.composeWithDevTools)(Object(je.applyMiddleware)(he.a)),Ee=Object(je.createStore)(Ce,Ae),Te=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).resetGame=e.resetGame.bind(Object(p.a)(e)),e}return Object(b.a)(n,[{key:"resetGame",value:function(){this.props.restartGameState()}},{key:"render",value:function(){return Object(c.jsx)("button",{id:"restart-button",onClick:this.resetGame,children:"RESTART"})}}]),n}(o.a.Component),Ge=Object(H.b)(null,(function(e){return{restartGameState:function(){return e({type:fe})}}}))(Te),De=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).state={endPosition:{},action:""},r.updatePosition=r.updatePosition.bind(Object(p.a)(r)),r.voiceAction=r.voiceAction.bind(Object(p.a)(r)),r.changeVoiceCommandAction=r.changeVoiceCommandAction.bind(Object(p.a)(r)),r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e;e=this.voiceAction,r.listen(function(){var t=Object(j.a)(d.a.mark((function t(n){var r,c,a,o,s,l,u;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.spectrogram,c=r.frameSize,a=r.data,o=k(a.subarray(39*-c)),s=f.o(o,[1].concat(y)),l=i.predict(s),u=l.argMax(1),t.next=7,e(u);case 7:f.d([s,l,u]);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{overlapFactor:.999,includeSpectrogram:!0,probabilityThreshold:.9})}},{key:"voiceAction",value:function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.data){e.next=6;break}return e.next=4,t.data();case 4:n=e.sent[0],this.changeVoiceCommandAction(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"changeVoiceCommandAction",value:function(e){this.setState({action:e}),console.log("voice command:",this.state.action)}},{key:"updatePosition",value:function(e){this.setState({endPosition:e})}},{key:"render",value:function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(Ge,{}),Object(c.jsxs)(g.a,{colorManagement:!0,shadowMap:!0,children:[Object(c.jsx)(D.a,{radius:100,depth:800,count:5e4}),Object(c.jsx)("hemisphereLight",{intensity:.5}),Object(c.jsx)("ambientLight",{intensity:.2}),Object(c.jsx)("spotLight",{castShadow:!0,penumbra:1,intensity:2,position:[150,300,-150],lookAt:[0,0,300],"shadow-mapSize-width":512,"shadow-mapSize-height":512,"shadow-camera-near":.1,"shadow-camera-far":500}),Object(c.jsxs)(N.a,{gravity:[0,-100,0],children:[Object(c.jsx)(ce,{rotation:[-Math.PI/2,0,0],position:[0,1,0]}),Object(c.jsx)(de,{store:Ee}),Object(c.jsxs)(a.Suspense,{fallback:Object(c.jsx)(te,{}),children:[Object(c.jsx)(K,{action:this.state.action,girlPosition:[0,0,200],stopListening:G,changeWin:this.props.changeWin,setAction:this.voiceAction,changePlaying:this.props.changePlaying,store:Ee}),Object(c.jsx)(X,{}),Object(c.jsx)(ee,{}),Object(c.jsx)(Z,{})]}),Object(c.jsx)(re,{rotation:[0,Math.PI/2,0],position:[-11,15,160]}),Object(c.jsx)(oe,{position:[0,0,-800]}),Object(c.jsx)(ae,{rotation:[0,-Math.PI/2,0],position:[13,0,-200]}),Object(c.jsx)(ae,{rotation:[0,Math.PI/2,0],position:[-15,0,-200]})]})]})]})}}]),n}(o.a.Component),Ne=n(111),We=n(110),Be=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).formatScore=e.formatScore.bind(Object(p.a)(e)),e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchLeaderboard(),console.log("Loading leaderboard")}},{key:"formatScore",value:function(e){if(e){var t,n,r,i=e;return t=Math.floor(i/60).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),n=Math.floor(i-60*t).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),r=Math.floor(i%1*100).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),"".concat(t,":").concat(n,":").concat(r)}return"00:00:00"}},{key:"render",value:function(){var e=this,t=this.props.leaderboard||[];return Object(c.jsx)(Ne.a,{centered:!0,show:this.props.showModal,onHide:this.props.toggleLeaderboard,dialogClassName:"leaderboard-modal",children:Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Midnight Train Leaderboard"}),Object(c.jsx)("div",{className:"table-shell",children:Object(c.jsxs)(We.a,{responsive:!0,children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{}),Object(c.jsx)("th",{children:"Name"}),Object(c.jsx)("th",{children:"Course Time"})]})}),Object(c.jsx)("tbody",{children:t.map((function(t,n){return Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{}),Object(c.jsx)("td",{children:t.name}),Object(c.jsx)("td",{children:Object(c.jsx)("i",{children:e.formatScore(t.score)})})]},n)}))})]})}),Object(c.jsx)("button",{onClick:this.props.toggleLeaderboard,children:"Close Leaderboard"})]})})}}]),n}(o.a.Component),ze=Object(H.b)((function(e){return{leaderboard:e.leaderboard}}),(function(e){return{fetchLeaderboard:function(){return e(function(){var e=Object(j.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Se.orderBy("score").get();case 3:n=e.sent,r=n.docs.map((function(e){return e.data()})),t(Pe(r)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}}}))(Be),Re=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).toggleSfx=new Audio("./sfx/toggle.mp3"),r.selectSfx=new Audio("./sfx/select.mp3"),r.state={showModal:!1},r.hoverSound=r.hoverSound.bind(Object(p.a)(r)),r.selectSound=r.selectSound.bind(Object(p.a)(r)),r.toggleLeaderboard=r.toggleLeaderboard.bind(Object(p.a)(r)),r}return Object(b.a)(n,[{key:"hoverSound",value:function(){this.toggleSfx.volume=.5,this.toggleSfx.play()}},{key:"selectSound",value:function(){this.selectSfx.volume=.5,this.selectSfx.play()}},{key:"toggleLeaderboard",value:function(){this.selectSound(),this.setState({showModal:!this.state.showModal})}},{key:"render",value:function(){var e=this;return Object(c.jsxs)("div",{className:"home",children:[Object(c.jsx)("div",{className:"title",children:Object(c.jsx)("h1",{children:"Midnight Train"})}),Object(c.jsxs)("div",{className:"message",children:[Object(c.jsx)("h2",{children:"A customized voice-command driven 3D interactive simulation"}),Object(c.jsx)("p",{children:"Train your player commands"})]}),Object(c.jsxs)("div",{id:"ml-button-row",children:[Object(c.jsx)("button",{id:"left",className:"all-buttons",onMouseDown:function(){return e.props.collect(0)},onMouseUp:function(){return e.props.collect(null)},children:"Left"}),Object(c.jsx)("button",{id:"right",className:"all-buttons",onMouseDown:function(){return e.props.collect(1)},onMouseUp:function(){return e.props.collect(null)},children:"Right"}),Object(c.jsx)("button",{id:"stop",className:"all-buttons",onMouseDown:function(){return e.props.collect(3)},onMouseUp:function(){return e.props.collect(null)},children:"Stop"}),Object(c.jsx)("button",{id:"go",className:"all-buttons",onMouseDown:function(){return e.props.collect(4)},onMouseUp:function(){return e.props.collect(null)},children:"Go"}),Object(c.jsx)("button",{id:"noise",className:"all-buttons",onMouseDown:function(){return e.props.collect(2)},onMouseUp:function(){return e.props.collect(null)},children:"Noise"}),Object(c.jsx)("button",{id:"train",className:"all-buttons",onClick:function(){return e.props.train()},children:"Train"}),Object(c.jsx)("button",{id:"listen",className:"all-buttons",onClick:function(){return e.props.listen()},children:"Test"})]}),Object(c.jsxs)("div",{id:"slider-row",children:[Object(c.jsxs)("div",{className:"slider-row-ind",children:[Object(c.jsx)("p",{children:"Left"}),Object(c.jsx)("input",{type:"range",id:"output",min:0,max:10,step:.1}),Object(c.jsx)("p",{children:"Right"})]}),Object(c.jsxs)("div",{className:"slider-row-ind",children:[Object(c.jsx)("p",{children:"Stop"}),Object(c.jsx)("input",{type:"range",id:"output2",min:0,max:10,step:.1}),Object(c.jsx)("p",{children:"Go"})]})]}),Object(c.jsx)("div",{id:"console"}),Object(c.jsxs)("div",{id:"button-row",children:[Object(c.jsx)("button",{id:"leaderboard-button",className:"all-buttons",onMouseOver:this.hoverSound,onClick:this.toggleLeaderboard,children:"Leaderboard"}),this.state.showModal&&Object(c.jsx)(ze,{showModal:this.state.showModal,toggleLeaderboard:this.toggleLeaderboard}),Object(c.jsx)("button",{id:"playButton",className:"all-buttons",onMouseOver:function(){return e.hoverSound()},onClick:function(){return e.props.changePlaying(),e.selectSound()},children:"Ride"})]})]})}}]),n}(o.a.Component),Fe=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).toggleSfx=new Audio("./sfx/toggle.mp3"),r.selectSfx=new Audio("./sfx/select.mp3"),r.state={name:"",showModal:!1,submitted:!1},r.submitScore=r.submitScore.bind(Object(p.a)(r)),r.handleChange=r.handleChange.bind(Object(p.a)(r)),r.resetGame=r.resetGame.bind(Object(p.a)(r)),r.toggleLeaderboard=r.toggleLeaderboard.bind(Object(p.a)(r)),r.hoverSound=r.hoverSound.bind(Object(p.a)(r)),r.selectSound=r.selectSound.bind(Object(p.a)(r)),r}return Object(b.a)(n,[{key:"hoverSound",value:function(){this.toggleSfx.volume=.5,this.toggleSfx.play()}},{key:"selectSound",value:function(){this.selectSfx.volume=.5,this.selectSfx.play()}},{key:"handleChange",value:function(e){this.setState({name:e.target.value})}},{key:"submitScore",value:function(e){e.preventDefault(),this.selectSound(),this.props.addToLeaderboard({name:this.state.name,score:this.props.time}),this.setState({submitted:!0})}},{key:"resetGame",value:function(){this.selectSound(),this.props.resetGame()}},{key:"toggleLeaderboard",value:function(){this.selectSound(),this.setState({showModal:!this.state.showModal})}},{key:"render",value:function(){var e,t,n,r=this,i=this.props.time;return e=Math.floor(i/60).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),t=Math.floor(i-60*e).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),n=Math.floor(i%1*100).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),i="".concat(e,":").concat(t,":").concat(n),Object(c.jsxs)("div",{className:"home",children:[Object(c.jsx)("div",{className:"title",children:Object(c.jsx)("h1",{children:"Course Complete"})}),Object(c.jsxs)("div",{className:"message",children:[Object(c.jsxs)("h2",{children:["Your time is ",Object(c.jsx)("strong",{children:i})]}),!this.state.submitted&&Object(c.jsx)("p",{children:"Add to leaderboard?"}),this.state.submitted?Object(c.jsx)("div",{children:Object(c.jsx)("h2",{children:Object(c.jsx)("strong",{children:"Score Submitted"})})}):Object(c.jsxs)("form",{id:"score-submission",onSubmit:function(e){return r.submitScore(e)},children:[Object(c.jsx)("label",{htmlFor:"name",children:"Name"}),Object(c.jsxs)("div",{id:"score-input",children:[Object(c.jsx)("input",{required:!0,name:"name",placeholder:"ABC",type:"text",value:this.state.name,onChange:function(e){return r.handleChange(e)}}),Object(c.jsx)("button",{onMouseOver:this.hoverSound,type:"submit",children:"Submit"})]})]})]}),Object(c.jsxs)("div",{id:"button-row",children:[Object(c.jsx)("button",{className:"all-buttons",id:"leaderboard-button",onMouseOver:this.hoverSound,onClick:this.toggleLeaderboard,children:"Leaderboard"}),this.state.showModal&&Object(c.jsx)(ze,{showModal:this.state.showModal,toggleLeaderboard:this.toggleLeaderboard}),Object(c.jsx)("button",{className:"all-buttons",id:"playButton",onMouseOver:this.hoverSound,onClick:this.resetGame,children:"Play again?"})]})]})}}]),n}(o.a.Component),Ue=Object(H.b)((function(e){return{time:e.time,leaderboard:e.leaderboard,gameState:e.gameState}}),(function(e){return{addToLeaderboard:function(t){return e((n=t,function(){var e=Object(j.a)(d.a.mark((function e(t){var r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=Se.doc(),e.next=4,r.set(n);case 4:i=e.sent,t(Le(i.data())),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()));var n},resetGame:function(){return e({type:ge})}}}))(Fe),_e=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).timer=0,e.state={startTime:performance.now(),elapsedTime:""},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval((function(){var t,n,r,i=Math.floor(performance.now()-e.state.startTime)/1e3;e.setState({elapsedTime:i}),t=Math.floor(i/60).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),n=Math.floor(i-60*t).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),r=Math.floor(i%1*100).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),document.getElementById("elapsed-time").innerHTML="".concat(t,":").concat(n,":").concat(r)}),10)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"resetTime",value:function(){this.setState({startTime:performance.now()})}},{key:"render",value:function(){return this.props.updateTime(this.state.elapsedTime),Object(c.jsxs)("div",{id:"stopwatch",children:[Object(c.jsx)("div",{id:"elapsed-time"}),Object(c.jsx)("hr",{}),Object(c.jsx)("p",{id:"elapsed-label",children:"ELAPSED TIME"})]})}}]),n}(o.a.Component),He=Object(H.b)(null,(function(e){return{updateTime:function(t){return e(function(e){return{type:Ie,time:e}}(t))}}}))(_e),qe=function(e){e.url;var t=function(e){var t=Object(a.useState)(new Audio("./music/E-Saggila-Aziza.wav")),n=Object(W.a)(t,1)[0],r=Object(a.useState)(!1),i=Object(W.a)(r,2),c=i[0],o=i[1];n.volume=.2,n.loop=!0;var s=function(){o(!c)};return Object(a.useEffect)((function(){c?n.play():n.pause()}),[c,n]),Object(a.useEffect)((function(){return window.addEventListener("click",(function e(t){s(),window.removeEventListener("click",e,!1)}),!1),n.addEventListener("ended",(function(){return o(!1)})),function(){n.removeEventListener("ended",(function(){return o(!1)}))}}),[]),[c,s]}(),n=Object(W.a)(t,2),r=n[0],i=n[1];return Object(c.jsxs)("div",{id:"audio-player",children:[Object(c.jsx)("button",{id:"audio-button",onClick:i,children:Object(c.jsx)("img",{src:"./icon/audio.png",alt:"play-audio-icon"})}),r&&Object(c.jsxs)("div",{id:"song-info",children:[Object(c.jsx)("h3",{children:"Aziza"}),Object(c.jsx)("h4",{children:"E-Saggila"})]})]})},Ve=function(e){return Object(c.jsx)("div",{id:"github",children:Object(c.jsx)("a",{href:"https://github.com/hannahrobot/city-walker",target:"_blank",rel:"noreferrer",children:Object(c.jsx)("img",{src:"./icon/github.png",alt:"link-to-github-repo"})})})},Ye=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).state={showModal:!0},e.toggleInstructions=e.toggleInstructions.bind(Object(p.a)(e)),e}return Object(b.a)(n,[{key:"toggleInstructions",value:function(){this.setState((function(e){return{showModal:!e.showModal}}))}},{key:"render",value:function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("button",{id:"instruction-button",onClick:this.toggleInstructions,children:"i"}),Object(c.jsxs)(Ne.a,{centered:!0,show:this.state.showModal,onHide:this.toggleInstructions,dialogClassName:"instruction-modal",children:[Object(c.jsx)("div",{children:Object(c.jsx)("h1",{children:"Riding simulation requires use of device microphone"})}),Object(c.jsxs)("div",{className:"table-shell",children:[Object(c.jsxs)(We.a,{responsive:!0,children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{children:"Buttons"}),Object(c.jsx)("th",{children:"Instructions"})]})}),Object(c.jsxs)("tbody",{children:[Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Go"}),Object(c.jsx)("td",{children:"Hold down and repeatedly state one syllable word until collected examples reaches around 800"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Stop"}),Object(c.jsx)("td",{children:"Hold down and repeatedly state one syllable word until collected examples reaches around 800"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Left"}),Object(c.jsx)("td",{children:"Hold down and repeatedly state one syllable word until collected examples reaches around 800"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Right"}),Object(c.jsx)("td",{children:"Hold down and repeatedly state one syllable word until collected examples reaches around 800"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Noise"}),Object(c.jsx)("td",{children:"Hold down to collect background noise until examples reaches around 800"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Train"}),Object(c.jsx)("td",{children:"Click to auto-train your player. Training is complete when Epoch reaches 130"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Test"}),Object(c.jsx)("td",{children:"Clickable when training is complete. Observe sliders to test responsiveness to spoken commands"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Ride"}),Object(c.jsx)("td",{children:"Begin game"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Listen"}),Object(c.jsx)("td",{children:"Begin listening for commands"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Screen click"}),Object(c.jsx)("td",{children:"Allows use of panning camera (cursor lock)"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"ESC Key"}),Object(c.jsx)("td",{children:"Camera Lock (show cursor)"})]})]})]}),Object(c.jsx)("p",{children:"Please Note: Game rendering is based on device GPU. Best performance of game will be dependent on device ability to render WebGL graphics."})]}),Object(c.jsx)("button",{onClick:this.toggleInstructions,children:"Close Instructions"})]})]})}}]),n}(o.a.Component),Ke=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).state={granted:"",action:""},e.changePlaying=e.changePlaying.bind(Object(p.a)(e)),e.changeWin=e.changeWin.bind(Object(p.a)(e)),e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){}},{key:"changePlaying",value:function(){var e=this.props.gameState;this.props.gameStatePlaying(!e.isPlaying)}},{key:"changeWin",value:function(){var e=this.props.gameState;this.props.gameStateWin(!e.hasWon)}},{key:"askPermission",value:function(){var e=this;return navigator.mediaDevices.getUserMedia({audio:!0}).then((function(){e.getPermission().then((function(t){e.setState({granted:t.state})}))})).catch((function(){e.getPermission().then((function(t){e.setState({granted:t.state})}))}))}},{key:"getPermission",value:function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.permissions.query({name:"microphone"});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderSwitch",value:function(e){return this.props.gameState.hasWon&&!this.props.gameState.isPlaying?Object(c.jsx)(Ue,{changeWin:this.changeWin,changePlaying:this.changePlaying}):this.props.gameState.isPlaying?Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(De,{action:this.state.action,changeWin:this.changeWin,changePlaying:this.changePlaying,voiceAction:this.changeVoiceCommandAction})}):Object(c.jsx)(Re,{changePlaying:this.changePlaying,collect:w,train:M,listen:T})}},{key:"render",value:function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(Ye,{}),Object(c.jsx)(qe,{}),this.renderSwitch(this.state.granted),this.props.gameState.isPlaying?Object(c.jsx)(He,{}):Object(c.jsx)(Ve,{})]})}}]),n}(o.a.Component),Je=Object(H.b)((function(e){return{gameState:e.gameState}}),(function(e){return{getGameState:function(){return e({type:pe})},gameStateWin:function(t){return e(function(e){return{type:me,hasWon:e}}(t))},gameStatePlaying:function(t){return e(function(e){return{type:Oe,isPlaying:e}}(t))}}}))(Ke),Xe=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,113)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),i(e),c(e),a(e)}))};l.a.render(Object(c.jsx)(H.a,{store:Ee,children:Object(c.jsx)(Je,{})}),document.getElementById("root")),Xe()},77:function(e,t,n){},84:function(e,t){},85:function(e,t){},86:function(e,t){},87:function(e,t){},88:function(e,t){},89:function(e,t){}},[[103,1,2]]]);
//# sourceMappingURL=main.a396f539.chunk.js.map